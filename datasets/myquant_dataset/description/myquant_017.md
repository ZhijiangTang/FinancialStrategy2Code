# 机器学习(股票)

分享

阅读 104353
 更新 2022-05-09 16:56:48

* [机器学习](#fd355596e307767d)
  + [1. 原理](#4d68e06c45acd2a2)
    - [什么是机器学习？](#04cfa6b561edc499)
    - [什么是支持向量机？](#275d1ccb0824bc2f)
    - [利用支持向量机预测股票涨跌](#e6a2445e80d3389e)
    - [参数优化](#c1d8043bae5414dc)
  + [2. 策略思路](#cf0127fe1bcb3311)
  + [3. 策略代码](#69a3fc437f0227e3)
  + [4. 回测结果与稳健性分析](#3e2df45effccee1c)

# 机器学习

## 1. 原理

### 什么是机器学习？

随着计算机技术的发展，投资者不再只局限于传统投资策略，机器学习在资本市场得到广泛应用。机器学习的核心是通过机器模仿人类的思考过程以及思维习惯，通过对现有数据的学习，对问题进行预测和决策。目前，机器学习已在人脸识别、智能投顾、自然语言处理等方面得到广泛应用。

机器学习可以分为两类，一类是无监督学习，另一类是监督学习。监督学习是指按照已有的标记进行学习，即已经有准确的分类信息。比如二分类问题，一类是“好”，另一类是“不好”，这种明确地指出分类基准的问题。这类模型包括：神经网络、决策树、支持向量机等。

无监督学习是指针对未标记过的数据集进行学习。比如聚类问题，没有准确的标准说明应该聚成几类，只有相对概念。这类模型包括：K\_means聚类、层次聚类法等。

### 什么是支持向量机？

支持向量机是最典型的一类机器学习模型，常用于解决二分类问题。支持向量机的原理是在一个样本空间内，找到一个平面，将样本数据分为两个部分，即两个分类，这个平面就叫做超平面。

**怎样确定超平面？**

假设有一个线性可分的二分类问题如图所示。  
![](/uploads/202011/attach_16461d0521da1346.png)

已知A、B、C三条线均可以将样本空间分为两类，那么问题来了，应该选择哪一个？

SVM模型指出，如果超平面能够将训练样本没有错误地分开，并且两类训练样本中离超平面最近的样本与超平面之间的距离是最大的，则把这个超平面称作最优超平面，即上图中的B平面。两类样本中距离最优超平面的点成为支持向量，支持向量机模型的名字由此得出。  
![](/uploads/202011/attach_16461d0732d39ead.png)

支持向量机背后的数学原理十分优美，但由于推导过程过于复杂，这里不再赘述。总之，支持向量机的核心就是寻找最优超平面。

支持向量机不仅可以解决线性可分问题，也可以解决非线性可分问题。其核心思想是将原始样本点映射到高维空间上，将非线性转化为线性可分，在高维空间中找到满足条件的最优超平面，再映射到低维空间中。

### 利用支持向量机预测股票涨跌

在利用支持向量机进行预测之前，先将数据集分为训练集和测试集。常用的分类方法是将数据及进行8:2分解，0.8部分是训练集，0.2部分是测试集。用训练集训练模型，再用测试集评价模型的准确率等指标。

在利用支持向量机预测时，还有很重要的一步是进行参数优化。SVM的参数包括以下几个。

| 参数符号 | 参数说明 |
| --- | --- |
| C | 罚函数，错误项的惩罚系数，默认为1。C越大，对错误样本的惩罚力度越大，准确度越高但泛化能力越低（泛化能力是指拓展到测试集中的准确率）。C越小，允许样本增加一点错误，使泛化能力提高。 |
| Kernel | 核函数，包括linear(线型核函数)、poly(多项式核函数)、rbf(高斯核函数)、sigmod(sigmod核函数)。 |
| degree | 当核函数选成多项式核函数时对应的阶数。 |
| Gamma | 核函数系数。 |

还有一些其他的参数，因为本示例不对其进行优化，所以这里不再赘述了。

### 参数优化

本示例采用网格搜索算法优化参数，训练好的参数为C = 0.6, gamma = 0.001,训练后的准确率为 0.50。（这个准确率虽然看起来很低，但在现实生活中准确率都处于较低水平，这里暂时用这个优化后的参数进行建模。）

## 2. 策略思路

第一步：获取原始数据，这里获取2016-04-01到2017-07-30的数据。  
第二步：计算SVM模型的输入变量。

**x 表示输入的特征值，共7个，分别为：**

| 参数符号 | 计算方法 |
| --- | --- |
| x1 | 最新收盘价/15日收盘价均值 |
| x2 | 现量/15日均量 |
| x3 | 最新最高价/15日均价 |
| x4 | 最新最低价/15日均价 |
| x5 | 现量 |
| x6 | 15日区间收益率 |
| x7 | 15日区间标准差 |

**y 表示5个交易日后收盘价是否上涨，**

| 参数符号 | 含义 |
| --- | --- |
| y = 1 | 表示股价上涨 |
| y = 0 | 表示股价下跌 |

第三步：利用训练好的模型预测股价未来走向。若上涨(y=1)则开仓。

第四步：设置止损止盈点。  
若已经持有仓位则在盈利大于10%的时候止盈，在星期五损失大于2%的时候止损。

回测时间：2017-07-01 09:00:00 到 2017-10-01 09:00:00  
回测初始资金：1000万  
回测标的：SHSE.600000

## 3. 策略代码

```