# 多因子选股(股票)

分享

阅读 187817
 更新 2022-05-09 16:56:48

* [多因子策略](#9999705c4a097b93)
  + [1. 原理](#4d68e06c45acd2a2)
    - [Fama-French三因子模型](#f2fdebfcb64333d9)
    - [策略设计思路（假设三因子模型是完全有效的）](#713a39754db63f0b)
  + [2. 策略步骤](#c306d1ad1c8a5699)
  + [3. 策略代码](#69a3fc437f0227e3)
  + [4. 回测结果与稳健性检验](#8fb635bf3a219945)

# 多因子策略

（注：以下部分内容引用自《因子投资：方法与实践》一书）

## 1. 原理

多因子策略是最广泛应用的策略之一。CAPM模型的提出为股票的收益提供了解释，但随着各种市场异象的出现，使得人们发现股票存在超额收益，这种收益不能为市场因子所解释，因此，出现了多因子模型。

多因子模型最早是由Fama-French提出，包括三因子和五因子模型。Fama认为，股票的超额收益可以由市场因子、市值因子和账面价值比因子共同解释。随着市场的发展，出现许多三因子模型难以解释的现象。因此，Fama又提出了五因子模型，加入了盈利水平、投资水平因子。

此后，陆续出现了六因子模型、八因子模型等，目前多少个因子是合适的尚无定论。

市场上常用的多因子模型包括如下几个。

| 模型 | 出处 | 所含因子 |
| --- | --- | --- |
| Fama-French三因子 | Fama and Farench(1993) | 市场、规模、价值 |
| Carhart四因子 | Carhart（1997） | 市场、规模、价值、动量 |
| Novy-Marx四因子 | Novy-Marx（2013） | 市场、规模、价值、盈利 |
| Fama-French五因子 | Fama and Farench(2015) | 市场、规模、价值、盈利、投资 |
| Hou-Xue-Zhang四因子 | Hou et al | 市场、规模、盈利、投资 |
| Stambaugh-Yuan四因子 | Stambaugh and Yuan(2017) | 市场、规模、管理、表现 |
| Daniel-Hirshleifer-Sun三因子 | Daniel et al（2020） | 市场、长周期行为、短周期行为 |

本策略以Fama提出的三因子模型作为基础。

### Fama-French三因子模型

在多因子模型出现以前，CAPM模型被奉为典型，几乎所有定价均是按照CAPM模型计算的。后来学者们发现了各种异象，这些异象无法用CAPM模型解释。较为典型的有Basu发现的盈利市值比效应和Banz发现的小市值效应。遗憾的是，虽然单一异象被发现后都对CAPM提出了挑战，但并没有形成合力，直到Fama三因子模型出现。

Fama等人在CAPM的基础上，Fama加入了HML和SMB两个因子，提出了三因子模型，也是多因子模型的基础。

![](/uploads/202011/attach_1646221cab7ec002.png)  
其中E[R\_i]代表股票i的预期收益率，R\_f代表无风险收益率，E[R\_m]为市场组合预期收益率，E[R\_SMB]和E[R\_HML]分别为规模因子收益率和价值因子预期收益率。  
  
为构建价值因子和规模因子，Fama选择BM和市值两个指标进行双重排序，将股票分为大市值组B和小市值组S；按照账面市值比将股票分为BM高于70%分位数的H组，BM低于30%分位数的L组，BM处于二者之间的记为M组。如表所示。  
![](/uploads/202011/attach_1646223b74c77c26.png)  
得到上述分组以后，就可以构建规模和价值两个因子。  
![](/uploads/202011/attach_16462244e23ef82a.png)

上述式子解释一下可以发现，规模因子是三个小市值组合的等权平均减去三个大市值组合的等权平均；价值因子是两个高BM组合的等权平均减去两个低BM组合的等权平均。

### 策略设计思路（假设三因子模型是完全有效的）

在用三因子模型估算股票预期收益率时，经常会发现并非每只股票都能严格吻合式1，大部分股票都会存在一个alpha截距项。当存在alpha截距项时，说明股票当前价格偏离均衡价格。基于此，可以设计套利策略。

alpha < 0时，说明股票收益率低于均衡水平，股票价格被低估，应该买入。  
alpha > 0时，说明股票收益率高于均衡水平，股票价格被高估，应该卖出。

因此，可以获取alpha最小并且小于0的10只的股票买入开仓。

## 2. 策略步骤

第一步：获取股票市值以及账面市值比数据。  
第二步：将股票按照各个因子进行排序分组，分组方法如上表所示。  
第三步：依据式2式3，计算SMB、HML因子。  
第四步：因子回归，计算alpha值。获取alpha最小并且小于0的10只的股票买入开仓。

回测期：2017-07-01 8:00:00 至 2017-10-01 16:00:00  
回测初始资金：1000万  
回测标的：沪深300成分股

## 3. 策略代码

```